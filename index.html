<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Conference Run of Show</title>
  <style>
    :root {
      --primary: #0a84ff; /* Apple-like blue */
      --accent: #00a699;  /* Airbnb green */
      --bg: #f9fafc;
      --text: #333;
    }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    /* Password Screen */
    #login-screen {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      background: linear-gradient(135deg, #ffffff, #f0f4f8);
    }

    .login-box {
      background: #fff;
      padding: 3rem;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.08);
      text-align: center;
      width: 100%;
      max-width: 360px;
    }

    .login-box h1 {
      font-size: 1.8rem;
      margin-bottom: 1.5rem;
      font-weight: 600;
    }

    .login-box input {
      width: 100%;
      padding: 0.9rem;
      margin-bottom: 1rem;
      border: 1px solid #ddd;
      border-radius: 12px;
      font-size: 1rem;
    }

    .login-box input:focus { border-color: var(--primary); }

    .login-box button {
      width: 100%;
      padding: 0.9rem;
      border: none;
      background: var(--primary);
      color: white;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
    }

    .login-box button:hover { background: #0071e3; }

    .error-msg { color: red; font-size: 0.9rem; margin-top: 0.5rem; }

    /* Main App */
    #app { display: none; }

    header {
      background: white;
      padding: 1rem;
      text-align: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      position: sticky;
      top: 0;
    }

    header h1 { margin: 0.5rem 0; font-weight: 600; }

    nav { margin-top: 0.5rem; }

    nav button {
      margin: 0.2rem;
      padding: 0.6rem 1rem;
      border: none;
      background: var(--primary);
      color: white;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9rem;
    }

    nav button.active { background: var(--accent); }

    .schedule-day {
      max-width: 900px;
      margin: 2rem auto;
      padding: 0 1rem;
    }

    .event {
      background: white;
      padding: 1.2rem;
      margin: 1rem 0;
      border-left: 5px solid var(--primary);
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,.05);
    }

    .event h3 { margin: 0 0 0.3rem 0; font-size: 1.2rem; font-weight: 600; }
    .event small { color: #666; display: block; margin-bottom: 0.6rem; }
    .event p { margin: 0.2rem 0; font-size: 0.95rem; }
  </style>
</head>
<body>

  <!-- ðŸ”’ Password Screen -->
  <div id="login-screen">
    <div class="login-box">
      <h1>Enter Access Code</h1>
      <input type="password" id="password" placeholder="Password" />
      <button onclick="checkPassword()">Unlock</button>
      <div class="error-msg" id="error"></div>
    </div>
  </div>

  <!-- ðŸ“… Main App -->
  <div id="app">
    <header>
      <h1>Conference Run of Show</h1>
      <nav id="day-nav"></nav>
    </header>
    <main id="schedule"></main>
  </div>

  <script>
    const PASSWORD = "FORWARD25"; // Frontend entry password

    // ðŸ”— Your deployed Apps Script URL
    const sheetUrl = "https://script.googleusercontent.com/a/macros/flexport.com/echo?user_content_key=AehSKLivdn9tzOtsfbf-LHI4XdSgjFG06-JBXvOPkqRNlWojB1PmbRdezDl5x99eC7c732TGE1PJPk7ka3iWh2B8aCR90tm56WGoCdhLb9par_d9IOXCfpCkrrZUIsIDNxcpw9MzFIPLf2dDM40NhDvEIMmNQ7EpvOnsYSTxCgd6h2I5bWZzRzkYE7r7XyGA4_qPF6eWNaYLN_rhJO4-kL25WLg5b6iUpR144kaaxIpidierc6T2dwaJcHuA-MBf_iBlUy97xeGP2CE0d0Rva_4CwDUrfRQ-lY7t_PY2twIqDv_ngvinbh0&lib=Moftsz8O_3FnQeQmqW7QGxSuhMqpg5Jk9&key=FORWARD25";

    function checkPassword() {
      const input = document.getElementById("password").value.trim();
      const error = document.getElementById("error");
      if (input === PASSWORD) {
        document.getElementById("login-screen").style.display = "none";
        document.getElementById("app").style.display = "block";
        loadData();
      } else {
        error.textContent = "Incorrect password. Try again.";
      }
    }

    function formatTime(value) {
      if (!value || value === "TBD") return "TBD";
      const date = new Date(value);
      return isNaN(date.getTime()) 
        ? value 
        : date.toLocaleTimeString([], {hour: 'numeric', minute:'2-digit'});
    }

    function formatDate(value) {
      const d = new Date(value);
      return isNaN(d.getTime()) 
        ? value 
        : d.toLocaleDateString("en-US", {weekday:'long', month:'long', day:'numeric'});
    }

    // Load JSON schedule
    async function loadData() {
      try {
        const response = await fetch(sheetUrl);
        const data = await response.json();

        // Group events by date
        const grouped = {};
        data.forEach(evt => {
          const day = formatDate(evt["Date"]);
          (grouped[day] ||= []).push(evt);
        });

        const dayNav = document.getElementById("day-nav");
        dayNav.innerHTML = "";
        Object.keys(grouped).forEach((day, index) => {
          const btn = document.createElement("button");
          btn.textContent = day;
          btn.onclick = () => showDay(day, grouped);
          if (index === 0) btn.classList.add("active");
          dayNav.appendChild(btn);
        });

        showDay(Object.keys(grouped)[0], grouped);
      } catch (e) {
        console.error("Error loading data:", e);
        document.getElementById("schedule").innerHTML = `
          <p style="text-align:center;color:red;">
            Error loading schedule.<br>
            Check console for details.
          </p>`;
      }
    }

    function showDay(day, grouped) {
      const schedule = document.getElementById("schedule");
      schedule.innerHTML = `<h2 style="text-align:center;margin-top:1.5rem;">${day}</h2>`;

      // Switch active nav
      document.querySelectorAll("nav button").forEach(btn => btn.classList.remove("active"));
      [...document.querySelectorAll("nav button")]
        .find(btn => btn.textContent === day).classList.add("active");

      const container = document.createElement("div");
      container.classList.add("schedule-day");

      grouped[day].forEach(evt => {
        const div = document.createElement("div");
        div.classList.add("event");
        div.innerHTML = `
          <h3>${evt["Item"] || "(No Title)"}</h3>
          <small>${formatTime(evt["Start Time"])}${evt["End Time"] ? " - " + formatTime(evt["End Time"]) : ""}</small>
          <p><strong>Speakers:</strong> ${evt["Speaker / Support"] || "N/A"}</p>
          <p><strong>Type:</strong> ${evt["Session Type"] || "N/A"}</p>
          <p><strong>Location:</strong> ${evt["Location"] || "N/A"}</p>
          <p><strong>Owner:</strong> ${evt["POC"] || "N/A"}</p>
          <p><strong>Notes:</strong> ${evt["Cue / Notes"] || ""}</p>
        `;
        container.appendChild(div);
      });

      schedule.appendChild(container);
    }
  </script>
</body>
</html>
